# Inyector de Tema Din√°mico (Claro/Oscuro) - AutoTheme.js

`AutoTheme.js` es un script de JavaScript robusto y sin dependencias que permite inyectar un completo sistema de cambio de tema (claro/oscuro) en cualquier p√°gina web con una sola l√≠nea de c√≥digo. Lo que comenz√≥ como un simple inversor de colores ha evolucionado hasta convertirse en una herramienta inteligente y resiliente, capaz de manejar los escenarios m√°s complejos de CSS y del DOM moderno.

**Ver Demo en Vivo**

!Demostraci√≥n del bot√≥n de tema y sus animaciones

---

## ‚ú® Caracter√≠sticas Principales

*   **Inversi√≥n Inteligente:** Utiliza un filtro CSS de `invert(1) hue-rotate(180deg)` para un cambio de tema instant√°neo y de alto rendimiento, ajustando los matices para que los colores (como el azul) no se conviertan en sus opuestos indeseados (amarillo).
*   **Bot√≥n Flotante Interactivo:**
    *   **Arrastrable:** El usuario puede mover el bot√≥n a cualquier lugar de la pantalla.
    *   **Posici√≥n Recordada:** Guarda la posici√≥n del bot√≥n en `localStorage`.
    *   **Estela de Part√≠culas:** Un efecto visual de part√≠culas de "fuego" (tema claro) o "hielo" (tema oscuro) sigue al bot√≥n mientras se arrastra.
    *   **√ìrbita de Sat√©lites:** Los botones de opciones (ocultar, selector de fondos) orbitan alrededor del bot√≥n principal con una animaci√≥n fluida.
*   **Detecci√≥n Autom√°tica del Sistema:** Aplica el tema oscuro o claro bas√°ndose en la preferencia del sistema operativo del usuario en la primera visita.
*   **Persistencia:** Guarda la elecci√≥n manual del usuario en `localStorage`, d√°ndole prioridad sobre la configuraci√≥n del sistema en visitas posteriores.
*   **Exclusiones Inteligentes:**
    *   **Autom√°ticas:** Excluye autom√°ticamente im√°genes (`<img>`), videos (`<video>`), `iframes`, y elementos con im√°genes de fondo para evitar su inversi√≥n. En su lugar, les aplica un sutil filtro de brillo y contraste en modo oscuro.
    *   **Detecci√≥n de Modales:** Usa un `MutationObserver` para detectar din√°micamente la aparici√≥n de modales, popups o cualquier elemento con `z-index` alto, excluy√©ndolos del filtro para que se muestren correctamente.
    *   **Manejo de `top-layer`:** Gestiona de forma expl√≠cita los elementos de la "capa superior" como `<dialog>` y la API de `popover`, que no son afectados por el filtro del `<html>`.
    *   **Manual:** Permite excluir elementos espec√≠ficos mediante selectores CSS o funciones de callback.
*   **Sincronizaci√≥n con `iframes`:** El script es capaz de inyectarse a s√≠ mismo en `iframes` del mismo origen para mantener el tema sincronizado en toda la aplicaci√≥n.
*   **Tutorial Interactivo:** La primera vez que un usuario interact√∫a con el bot√≥n, un peque√±o tutorial guiado le ense√±a a usar las funciones de ocultar y las opciones adicionales.
*   **Selector de Fondos (Opcional):** Incluye una clase `GradientSelector` que a√±ade un modal para que el usuario pueda elegir entre m√°s de 200 fondos de degradado para la p√°gina.
*   **Accesibilidad:** Incluye atributos `aria-label`, `aria-pressed` y una regi√≥n `aria-live` para anunciar los cambios de tema a los lectores de pantalla.
*   **Atajos de Teclado:**
    *   `T`: Restaura el bot√≥n de tema si ha sido ocultado.
    *   `G`: Abre/cierra el modal de selecci√≥n de fondos.

---

## üöÄ C√≥mo Usarlo

La integraci√≥n es incre√≠blemente sencilla.

1.  **Incluye el script** en tu archivo HTML. Es importante que sea de tipo `module`.

    ```html
    <script type="module" src="theme-generator.js"></script>
    ```

2.  **¬°Listo!** El script se inicializar√° autom√°ticamente al cargar el DOM. Detectar√° los colores de tu p√°gina y crear√° el bot√≥n flotante.

### Configuraci√≥n Avanzada

Dentro de `theme-generator.js`, puedes personalizar la inicializaci√≥n para un control m√°s preciso.

```javascript
// Al final del archivo theme-generator.js

document.addEventListener('DOMContentLoaded', () => {
    // 1. Define los colores base de tu tema claro.
    const myBrandColors = {
      surface: '#ffffff', // Color de fondo principal
      text: '#2c3e50'     // Color de texto principal
    };

    // 2. Instancia el selector de gradientes (opcional).
    const gradientSelector = new GradientSelector(GRADIENTS, { shortcutKey: 'g' });

    // 3. Instancia el gestor de tema con tus opciones.
    new AutoTheme(myBrandColors, {
      shortcutKey: 't', // Tecla para restaurar el bot√≥n
      gradientSelector: gradientSelector, // Inyecta la dependencia del selector de fondos
      
      // Ejemplo de exclusiones personalizadas:
      exclude: [ 
        '.logo-principal', // Excluir por selector CSS
        '#mapa-interactivo', // Excluir por ID
        (el) => el.classList.contains('no-invertir') // Excluir mediante una funci√≥n
      ]
    });
});
```

---

## ‚öîÔ∏è Desaf√≠os Conquistados

Este script ha sido probado y optimizado para manejar una gran cantidad de casos l√≠mite de CSS que a menudo causan problemas con los inversores de tema. La p√°gina de demostraci√≥n incluye pruebas para todos estos niveles de desaf√≠o:

### Nivel B√°sico
*   Pesta√±as, Modales, Im√°genes, Videos, Iframes, Fondos CSS, Pseudo-elementos, Iconos SVG, Canvas, Formularios.

### Nivel Experto
*   Shadow DOM, `mix-blend-mode`, Filtros CSS apilados, Tablas complejas, Elementos deshabilitados.

### Nivel Pesadilla
*   `backdrop-filter`, `position: sticky`, Animaciones CSS complejas, `details` y `summary`, `clip-path` con variables CSS, `writing-mode`.

### Nivel Ultra Hard
*   Transformaciones 3D, `mask-image`, Animaciones por Scroll (`animation-timeline`), CSS Houdini (Paint API), `will-change`.

### Nivel DIOS
*   Popover API (`@top-layer`), Container Queries (`@container`), Animaciones `offset-path`, `color-mix()`, Houdini `@property`.

### Nivel Ultra Maldad
*   Elemento `<dialog>` nativo y `::backdrop`, `shape-outside`, Filtros SVG complejos, Custom Highlight API.

### Nivel APOCALIPSIS
*   Sincronizaci√≥n de tema con documentos HTML anidados en `<iframe>` y `<object>`.

---

## üé® Arte para el Alma

Este proyecto est√° dedicado a mi bella Dulce.

```


```

---

## Autor

*   **HECTOR DANIEL AYARACHI FUENTES**

---

## Licencia

Este proyecto est√° bajo la Licencia MIT.